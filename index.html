<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>VolixyHub.cc - Movies</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;}
        body{background:#0a001a;color:#e0c0ff;font-family:system-ui;overflow:hidden;height:100vh;position:relative;}
        canvas{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:1;}
        #grid{padding:20px;display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:18px;height:100vh;overflow-y:auto;}
        .card{background:rgba(100,0,180,0.5);border-radius:15px;overflow:hidden;position:relative;cursor:pointer;box-shadow:0 0 20px rgba(255,0,255,0.3);}
        .thumb{width:100%;height:420px;object-fit:cover;}
        .title{padding:12px;color:#ff00ff;font-weight:bold;text-align:center;font-size:18px;}
        .del{position:absolute;top:8px;right:8px;background:#ff0066;color:white;padding:6px 12px;border-radius:8px;display:none;cursor:pointer;z-index:10;}
        .card:hover .del{display:block;}
        #plus{position:fixed;bottom:25px;right:25px;background:#ff00ff;width:70px;height:70px;border-radius:50%;font-size:42px;color:white;border:none;box-shadow:0 0 60px #ff00ff;z-index:100;cursor:pointer;}
        #overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.92);z-index:99;}
        #modal{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#200040;padding:30px;border-radius:20px;width:90%;max-width:420px;box-shadow:0 0 90px #ff00ff;z-index:100;}
        #playerModal{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#000;padding:20px;border-radius:20px;width:95%;max-width:900px;z-index:100;}
        #playerModal iframe,#playerModal video{width:100%;height:70vh;border:none;border-radius:15px;}
        input{margin:12px 0;width:100%;padding:16px;border-radius:12px;border:none;background:#300060;color:white;font-size:16px;}
        button{width:100%;padding:16px;background:#ff00ff;color:white;border:none;border-radius:12px;margin-top:15px;font-size:18px;cursor:pointer;}
        button:hover{opacity:0.9;}
        .closePlayer{position:absolute;top:15px;right:20px;background:#ff0066;color:white;padding:10px 15px;border-radius:50%;cursor:pointer;z-index:101;}
    </style>
</head>
<body>

<canvas></canvas>

<!-- PLUS BUTTON -->
<button id="plus" onclick="openModal()">+</button>

<!-- DARK OVERLAY -->
<div id="overlay" onclick="closeModal()"></div>

<!-- POST MOVIE POPUP (NOW WITH CORRECT IDs) -->
<div id="modal">
    <h2 style="color:#ff00ff;text-align:center;margin-bottom:20px;">Leak a Movie</h2>
    <input type="text" id="movieName" placeholder="Movie name (ex: Joker 2019)">
    <input type="url" id="movieURL" placeholder="Movie link (Vidify, YouTube, MP4)">
    <input type="url" id="movieIMG" placeholder="Movie image link (Google → right click → copy image address)">
    <button onclick="postMovie()">POST MOVIE</button>
    <button onclick="closeModal()">Cancel</button>
</div>

<!-- PLAYER POPUP -->
<div id="playerModal" onclick="closePlayer()">
    <div class="closePlayer" onclick="closePlayer()">X</div>
    <div id="player"></div>
</div>

<div id="grid"></div>

<script>
// Load movies from localStorage
let movies = JSON.parse(localStorage.getItem("volixyMovies") || "[]");
let nextId = movies.length ? Math.max(...movies.map(m=>m.id)) + 1 : 1;

movies.forEach(m => createCard(m.name, m.url, m.img, m.id));

function openModal() {
    document.getElementById('overlay').style.display = 'block';
    document.getElementById('modal').style.display = 'block';
}
function closeModal() {
    document.getElementById('overlay').style.display = 'none';
    document.getElementById('modal').style.display = 'none';
    document.getElementById('movieName').value = '';
    document.getElementById('movieURL').value = '';
    document.getElementById('movieIMG').value = '';
}

function postMovie() {
    const name = document.getElementById('movieName').value.trim();
    const url = document.getElementById('movieURL').value.trim();
    const img = document.getElementById('movieIMG').value.trim() || "https://via.placeholder.com/400x600/300060/ffffff?text=No+Image";

    if (!name || !url) return alert("Name and link are required!");

    createCard(name, url, img, nextId);
    movies.push({id: nextId, name, url, img});
    localStorage.setItem("volixyMovies", JSON.stringify(movies));
    nextId++;
    closeModal();
}

function createCard(name, url, img, id) {
    const card = document.createElement('div');
    card.className = 'card';
    card.innerHTML = `
        <img src="${img}" class="thumb" onerror="this.src='https://via.placeholder.com/400x600/300060/ffffff?text=No+Image'">
        <div class="title">${name}</div>
        <div class="del" onclick="deleteMovie(${id});event.stopPropagation()">X</div>
    `;
    card.onclick = () => playMovie(url);
    document.getElementById('grid').appendChild(card);
}

function playMovie(url) {
    let player;
    if (url.includes('vidify.top')) {
        player = `<iframe src="${url}" allowfullscreen></iframe>`;
    } else if (url.includes('youtube.com') || url.includes('youtu.be')) {
        const id = url.split('v=')[1]?.split('&')[0] || url.split('/').pop();
        player = `<iframe src="https://www.youtube.com/embed/${id}" allowfullscreen></iframe>`;
    } else {
        player = `<video controls autoplay><source src="${url}"></video>`;
    }
    document.getElementById('player').innerHTML = player;
    document.getElementById('overlay').style.display = 'block';
    document.getElementById('playerModal').style.display = 'block';
}

function closePlayer() {
    document.getElementById('overlay').style.display = 'none';
    document.getElementById('playerModal').style.display = 'none';
    document.getElementById('player').innerHTML = '';
}

function deleteMovie(id) {
    if (confirm("Delete this movie forever?")) {
        movies = movies.filter(m => m.id !== id);
        localStorage.setItem("volixyMovies", JSON.stringify(movies));
        location.reload();
    }
}

// Snow background
let c=document.querySelector("canvas"),ctx=c.getContext("2d");
c.width=innerWidth;c.height=innerHeight;
let s=[];
for(let i=0;i<400;i++) s.push({x:Math.random()*c.width,y:Math.random()*c.height,r:Math.random()*3+1,spd:Math.random()*1.5+0.5});
function snow(){
    ctx.clearRect(0,0,c.width,c.height);
    s.forEach(p=>{
        ctx.fillStyle="rgba(255,200,255,0.9)";
        ctx.beginPath();
        ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
        ctx.fill();
        p.y+=p.spd;
        if(p.y>c.height) p.y=-10;
    });
    requestAnimationFrame(snow);
}
snow();
</script>
</body>
</html>
